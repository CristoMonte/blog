---
title: js 打印
date: '2020-01-16'
spoiler: js实现打印
---

> 最近需要实现打印功能，A4打印和热敏打印都有实现，记录遇到的问题和解决的方案。

- 打印需要使用绝对单位，保证在任何地方显示都是一致的

第一次实现打印使用了px单位，A4打印，虽然说最后实现了，但是这种方式是很蠢的，px天生是为屏幕而生的单位，而打印更应该使用一些绝对单位来实现，cm, mm, in等等，绝对单位的意思是，在css内与在任何其他地方，他们都是一样的，[更多信息可以查看这里。](https://www.w3.org/Style/Examples/007/units.zh_CN.html)

- @page 打印页面的结构设置和分页设置。

在实现热敏打印的时候发现微信浏览器下无论怎么设置自己的html，都会有一段页面边距，在普通浏览器下打印没有边距，最后找了很久才找到问题和解决方案。关于打印页面的结构和标准盒模型差不多，通过@page可以设置打印结构，分页, @page只能作用于某些特定的css属性，，[具体可以查看这里。](https://segmentfault.com/a/1190000010145260)

- 打印的时候尽量将页面的background去掉或者设置为白色，文件颜色设置为黑色。

一开始没有设置文字颜色，总觉得浏览器文字的默认颜色就是黑色，不用设置也行，打印发现，不设置颜色打印不是很清晰，可能是因为打印机分辨率问题。总之，最好还是将文字的颜色设置为黑色。

- 打印一般使用window.print, 如果在打印前或者打印后需要处理一些逻辑可以通过注册window.onbeforeprint， window.onafterprint事件